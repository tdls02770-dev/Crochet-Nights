<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CN</title>
  <link rel="stylesheet" href="style.css">
  <style>
    :root{
      --bg:#0b0f19; --card:#1c1f2b; --muted:#9ca3af; --accent:#fbbf24; --glass:rgba(28,31,43,0.7);
      --radius:14px; --shadow:0 6px 18px rgba(0,0,0,0.5);
      font-family: Inter, system-ui, sans-serif;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#111827);color:#f3f4f6}
    .container{max-width:1200px;margin:0 auto;padding:32px}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:18px 0}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#f59e0b);display:flex;align-items:center;justify-content:center;color:black;font-weight:700}
    .btn{background:var(--card);border:1px solid rgba(255,255,255,0.06);padding:10px 14px;border-radius:10px;cursor:pointer;box-shadow:var(--shadow);color:#f3f4f6}
    .btn2 {margin-left:60%; background-color:var(--card); border:1px solid rgba(255,255,255,0.06); padding:10px 14px; border-radius:10px; cursor:pointer; box-shadow:var(--shadow); color:#f3f4f6;}
    .cart-btn{position:relative}
    .count{position:absolute;top:-8px;right:-8px;background:#ef4444;color:white;border-radius:999px;width:20px;height:20px;display:flex;align-items:center;justify-content:center;font-size:12px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:20px;margin-top:20px}
    .card{background:var(--card);padding:16px;border-radius:16px;box-shadow:var(--shadow);border:1px solid rgba(255,255,255,0.06);transition:transform .3s ease}
    .card:hover{transform:translateY(-4px)}
    .card h3{margin:10px 0 6px;font-size:16px}
    .card p{margin:0;color:var(--muted);font-size:14px}
    .price-row{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
    .price{font-weight:700;color:var(--accent)}
    .add{background:var(--accent);color:black;padding:8px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:600}
    footer{padding:36px 0;color:var(--muted);text-align:center}
  </style>
</head>
<body>
  <div class="container">
    <nav class="nav">
      <div class="brand">
        <div class="logo"><img class="logoImg" src="logo.jpg"></div>
        <div>
          <div style="font-weight:700">متجر ليالي الكروشيه</div>
          <div style="font-size:12px;color:var(--muted)"></div>
        </div>
      </div>
      
      <button class="btn cart-btn" id="openCart">🛒<span class="count" id="cartCount">0</span></button>
    </nav>

    <h2 style="margin-top:10px;margin-left: 80%;">منتجاتنا</h2>
    <div class="grid" id="productGrid"></div>

    <footer>&copy; 2025 متجر ليالي الكروشيه <br> تواصل:</footer>
  </div>

  <!-- CART -->
  <div id="cartDrawer" style="position:fixed;right:18px;bottom:18px;background:var(--card);border-radius:12px;padding:14px;box-shadow:0 12px 40px rgba(0,0,0,0.7);display:none;min-width:320px">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
      <strong>سلتك</strong>
      <button onclick="toggleCart()" class="btn">إغلاق</button>
    </div>
    <div id="cartItems" style="max-height:260px;overflow:auto;min-height:40px"></div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
      <div style="color:var(--muted)">المجموع</div>
      <div id="cartTotal" style="font-weight:800">$0</div>
    </div>
    <div style="margin-top:12px;text-align:right">
      <button class="add" onclick="checkout()">الدفع</button>
    </div>
  </div>

  <!-- CHECKOUT -->
  <div id="checkoutForm" style="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:var(--card);padding:20px;border-radius:14px;box-shadow:0 12px 40px rgba(0,0,0,0.7);display:none;min-width:320px">
    <h3>إدخال بيانات الدفع</h3>
    <label>الاسم<br><input id="custName" style="width:100%;padding:8px;border-radius:8px;margin-bottom:10px"></label>
    <label>البريد الإلكتروني<br><input id="custEmail" type="email" style="width:100%;padding:8px;border-radius:8px;margin-bottom:10px"></label>
    <label>العنوان<br><input id="custAddress" style="width:100%;padding:8px;border-radius:8px;margin-bottom:10px"></label>
    <label>رقم الجوال<br><input id="custPhone" type="tel" style="width:100%;padding:8px;border-radius:8px;margin-bottom:10px"></label>
    <label>طريقة الدفع<br>
      <select id="custPayment" style="width:100%;padding:8px;border-radius:8px;margin-bottom:10px">
        <option value="">-- اختر طريقة الدفع --</option>
        <option value="cod">الدفع عند الاستلام</option>
        <option value="bank">تحويل بنكي</option>
      </select>
    </label>
    <div style="display:flex;gap:8px;justify-content:flex-end">
      <button class="btn" onclick="closeCheckout()">إلغاء</button>
      <button class="add" onclick="confirmCheckout()">تأكيد</button>
    </div>
  </div>

  <script>
    const PRODUCTS = [
      {id:1,name:'وردة كروشيه',desc:'ورد صغيره خفيفه',price:10,img:'logo.jpg',},
      {id:2,name:'موكيه كروشيه',desc:'موكيه ورد',price:25,img:'logo.jpg',},
      {id:3,name:"ميداليه مفاتيح",desc:'حامل مفاتيح',price:14,img:'logo.jpg',},
    ];

    const grid = document.getElementById("productGrid");
    grid.innerHTML = PRODUCTS.map(p => `
      <div class="card">
        <div style="height:160px;background:linear-gradient(135deg,#1f2937,#374151);border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700;"><img class="img4pro" src=${p.img}></div>
        <h3>${p.name}</h3>
        <p>${p.desc}</p>
        <div class="price-row">
          <div class="price">ر.س${p.price}</div>
          <button class="add" onclick="addToCart(${p.id})">أضف</button>
        </div>
      </div>
    `).join('');

    let cart = [];

    function addToCart(id){
      const prod = PRODUCTS.find(p=>p.id===id);
      const cur = cart.find(c=>c.id===id);
      if(cur) cur.qty++;
      else cart.push({id:prod.id,name:prod.name,price:prod.price,qty:1});
      updateCartUI();
    }

    function updateCartUI(){
      const count = cart.reduce((s,i)=>s+i.qty,0);
      document.getElementById('cartCount').textContent = count;
      const list = document.getElementById('cartItems');
      if(cart.length===0) list.innerHTML = '<div style="color:var(--muted)">السلة فارغة</div>';
      else list.innerHTML = cart.map(i=>`
        <div style="display:flex;justify-content:space-between;margin-bottom:8px">
          <div><strong>${i.name}</strong><div style="color:var(--muted);font-size:13px">${i.qty} × $${i.price}</div></div>
          <div style="text-align:right">
            <div style="font-weight:700;color:var(--accent)">$${(i.price*i.qty).toFixed(2)}</div>
            <button class="btn" onclick="removeOne(${i.id})" style="margin-top:6px">-</button>
          </div>
        </div>`).join('');
      const total = cart.reduce((s,i)=>s + i.price * i.qty,0);
      document.getElementById('cartTotal').textContent = `ر.س${total.toFixed(2)}`;
    }

    function removeOne(id){
      const idx = cart.findIndex(c=>c.id===id);
      if(idx===-1)return;
      cart[idx].qty--;
      if(cart[idx].qty<=0)cart.splice(idx,1);
      updateCartUI();
    }

    function toggleCart(force){
      const d = document.getElementById("cartDrawer");
      if(force===true) d.style.display="block";
      else d.style.display = d.style.display==="block"?"none":"block";
    }

    document.getElementById("openCart").addEventListener("click",()=>toggleCart(true));

    function checkout(){
      if(cart.length===0){alert("السلة فارغة");return}
      document.getElementById("checkoutForm").style.display="block";
    }
    function closeCheckout(){
      document.getElementById("checkoutForm").style.display="none";
    }

    async function confirmCheckout(){
      const name=document.getElementById('custName').value.trim();
      const email=document.getElementById('custEmail').value.trim();
      const address=document.getElementById('custAddress').value.trim();
      const phone=document.getElementById('custPhone').value.trim();
      const payment=document.getElementById('custPayment').value.trim();
      if(!name||!email||!address||!phone||!payment){alert('يرجى إدخال جميع البيانات');return}

      const order = {
        customer:{name,email,address,phone,payment: payment==="cod"?"الدفع عند الاستلام":"تحويل بنكي"},
        items:cart,
        total:cart.reduce((s,i)=>s + i.price * i.qty,0),
        date:new Date().toISOString()
      };

      try {
        const res = await fetch("https://68fb56f094ec96066025b1bc.mockapi.io/orders",{
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body:JSON.stringify(order)
        });
        if(res.ok){
          alert("تم إرسال الطلب بنجاح ✅");
          cart=[];updateCartUI();closeCheckout();toggleCart();
        } else {
          alert("حدث خطأ أثناء إرسال الطلب");
        }
      } catch(e){
        alert("فشل الاتصال بالخادم");
        console.error(e);
      }
    }

    updateCartUI();
  </script>
</body>
</html>
